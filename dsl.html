<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Security-Policy" content="default-src 'self' http: https: ws: wss: 'unsafe-inline';">
<title>Rendered by Ensuite</title>
</head>
<body>
<style name="assets/fonts.css" type="text/css">/* inter-regular - latin */
@font-face {
  font-family: 'Inter';
  font-style: normal;
  font-weight: 400;
  src: url('assets/fonts/inter-v8-latin-regular.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('assets/fonts/inter-v8-latin-regular.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('assets/fonts/inter-v8-latin-regular.woff2') format('woff2'), /* Super Modern Browsers */
       url('assets/fonts/inter-v8-latin-regular.woff') format('woff'), /* Modern Browsers */
       url('assets/fonts/inter-v8-latin-regular.ttf') format('truetype'), /* Safari, Android, iOS */
       url('assets/fonts/inter-v8-latin-regular.svg#Inter') format('svg'); /* Legacy iOS */
}

/* inter-600 - latin */
@font-face {
  font-family: 'Inter';
  font-style: normal;
  font-weight: 600;
  src: url('assets/fonts/inter-v8-latin-600.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('assets/fonts/inter-v8-latin-600.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('assets/fonts/inter-v8-latin-600.woff2') format('woff2'), /* Super Modern Browsers */
       url('assets/fonts/inter-v8-latin-600.woff') format('woff'), /* Modern Browsers */
       url('assets/fonts/inter-v8-latin-600.ttf') format('truetype'), /* Safari, Android, iOS */
       url('assets/fonts/inter-v8-latin-600.svg#Inter') format('svg'); /* Legacy iOS */
}


</style>
<style name="ensuite/node_modules/highlight.js/styles/school-book.css" type="text/css">pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#3e5915;background:#f6f5b2}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#059}.hljs-subst{color:#3e5915}.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-bullet,.hljs-link,.hljs-section,.hljs-string,.hljs-symbol,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#2c009f}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#e60415}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-section,.hljs-selector-id,.hljs-selector-tag,.hljs-strong,.hljs-title,.hljs-type{font-weight:700}.hljs-emphasis{font-style:italic}</style>
<style name="assets/style.css" type="text/css">* { box-sizing: border-box; margin: 0; padding: 0; line-height: 1.5; }

body { color: #123; font-size: 16px; font-family: "Inter", sans-serif; }
body { background-color: #f0f0f0; background-image: url('assets/bg.svg'); background-repeat: repeat; }

body > header {
  text-align: center;
  max-width: 80rem;
  margin: 0 auto;
  padding: 2rem 2rem 1rem;
}
body > header { display: flex; flex-flow: row nowrap; justify-content: space-around; align-items: center; }
body > header .logo, .logo img { display: block; margin: 0; flex-shrink: 1; }
body > header .logo img { max-width: 16rem; max-height: 16rem; }
body > header .badges { margin-bottom: 1rem; }
body > header a.badge { display: inline-block; padding: 0.25rem 0.5rem; }

section { padding: 1em; }

footer { padding: 1em; }

a { text-decoration: none; }
a:hover { text-decoration: underline; }
a, a:focus, a:visited, a:active, a:hover { color: rgb(101, 179, 76) }

h1, h2, h3, h4 { font-weight: 600 }
h1 { font-size: 3em;     line-height: 3rem;   margin-bottom: 2rem;                     }
h2 { font-size: 1.75em;  line-height: 2rem;   margin-bottom: 1rem;   margin-top: 0;    }
h3 { font-size: 1.5rem;  line-height: 2rem;   margin-bottom: 1rem;                     }
h4 { font-size: 1.25em;  line-height: 1.5rem; margin-bottom: 0.5rem; margin-top: 2rem; }
h5 { font-size: 1.125em; line-height: 1.5rem; margin-bottom: 0.5rem; margin-top: 2rem; }

button, .button {
  display: inline-block;
  background: rgb(101, 179, 76);
  color: white;
  padding: 0 1em;
  margin: 1em 0;
  text-shadow: -1px -1px 0 black;
  box-shadow: 1px 1px 0 black;
}
a.button:focus, a.button:visited, a.button:active, a.button:hover {
  color: white;
}

th, td { text-align: left; vertical-align: top; }
th { padding-right: 5em }

.grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  flex-flow: row wrap;
  justify-content: center;
  max-width: 80rem;
  margin: 0 auto 3rem;
}

@media (max-width: 80rem) {
  .grid {
    display: flex;
    flex-flow: column nowrap;
  }
  .grid .feature {
    display: flex;
    flex-flow: row nowrap;
  }
  .grid .feature .links {
    flex-shrink: 0;
    width: 33%;
    margin: 0 0 0 2rem;
  }
  .table-of-contents {
    width: 1rem;
  }
}

@media (max-width: 48rem) {
  .grid .feature .links {
    width: 50%;
  }
}

.big-left { grid-column-start: 1; grid-column-end: 3; }
.big-center { grid-column-start: 2; grid-column-end: 4; }
.big-right { grid-column-start: 3; grid-column-end: 5; }
.big-all { grid-column-start: 1; grid-column-end: 5; }

.feature {
  padding: 1rem;
  margin: 1rem 0.5rem 0;
  border: 1px solid rgba(0,0,0,0.1);
  border-top-color: rgba(255,255,255,0.5);
  border-left-color: rgba(255,255,255,0.5);
  border-radius: 3px;
  box-shadow: 3px 3px 6px rgba(0,0,0,0.1);
  display: flex;
  flex-flow: column nowrap;
  background: #fff;
}

.feature .docs {
  font-weight: bold;
}

#features .feature {
  min-height: 10rem;
}

.left {
  text-align: left;
}
.center {
  text-align: center;
}

.feature .description {
  line-height: 1.5;
  font-size: 0.875rem;
}

code { font-size: 0.9375rem; }
code.inline, code.block { background: #0c5749; color: white; font-family: monospace; font-weight: bold; }
code.inline { display: inline-block; padding: 0.5rem 1rem; margin: 0 0.5rem; }
code.block {
  display: block;
  padding: 1rem;
  margin: 1rem auto;
  border-radius: 0.5rem;
  max-width: 40rem;
  line-height: 1rem;
}

.feature-logo {
  margin-bottom: 0.5rem;
  height:        5rem;
  width:         12rem;
  align-self:    center;
}

.tag {
  font-size: 0.8rem;
  background: #f5faf3;
  border: 1px solid #437733;
  color: #437733;
  display: inline-block;
  padding: 0.25rem 0.5rem;
  margin: 0.5rem 0 0;
  align-self: flex-start;
  border-radius: 3px;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.spacer {
  flex-grow:  1;
  min-height: 0.5rem;
}

pre, code {
  font-family: monospace;
}

p {
  line-height: 1.5rem;
  margin-top: 0;
  margin-bottom: 0.5rem;
}

svg.icon {
  width: 2rem;
  height: 2rem;
}
a > svg.icon {
  fill: rgb(101, 179, 76);
  width: 1.5rem;
  height: 1.5rem;
  line-height: 1rem;
  vertical-align: baseline;
  margin-right: 0.5rem;
  flex-shrink: 0;
}
.feature a.docs {
  display: flex;
  flex-flow: row nowrap;
  align-items: flex-start;
  font-weight: normal;
  text-decoration: none;
  padding: 0.5rem 0;
  cursor: default;
  color: #888;
}
.feature a.docs[href] {
  text-decoration: underline;
  color: rgb(67, 119, 51);
  cursor: pointer;
}

@keyframes hourglass {
  50%  { transform: rotateZ(0);      }
	100% { transform: rotateZ(180deg); }
}

svg.icon-todo {
  animation-name: hourglass;
  animation-duration: 3s;
  animation-delay: 1s;
  animation-iteration-count: infinite;
}

.links {
  display: flex;
  flex-flow: column nowrap;
}
.links > a {
  margin-right: 1rem;
  transition:
    padding-left 0.33s,
    margin-right 0.33s;
}
.links > a[href]:hover {
  padding-left: 0.5rem;
  margin-right: 0.5rem;
}
.feature pre {
  background: #eee;
  padding: 0.5rem;
  border-radius: 0.1rem;
  font-size: 0.875rem;
  font-weight: normal;
  margin-top: 1rem;
  color: #555;
}

/*.feature .links .icon { fill: #F46623 }*/

.feature.invert { background: rgb(67, 119, 51); color: white; }
.feature.invert * { color: white; fill: white; }
.feature.invert a.docs { color: white; }
.feature.invert a.docs[href] { text-decoration: underline; }

.feature.foss { background: #2e0056; color: white; }
.feature.foss * { color: white; fill:  white; }
.feature.foss a.docs { color: white; }

.icon-todo { fill: #aaa !important; }

#quick-start {
  text-align: center;
  flex-grow: 1;
}

.ensuite-md-rendered {
  /*background: white;*/
  /*display: block;*/
  /*max-width: 54rem;*/
  /*margin: 3rem auto 0 38%;*/
  /*padding: 3rem;*/
  /*box-shadow: 3px 3px 6px rgba(0,0,0,0.1)*/
  display: flex;
  flex-flow: row nowrap;
  justify-content: center;
}


.ensuite-md-content {
  background: white;
  padding:    5rem 3rem 2rem;
  box-shadow: 3px 3px 6px rgba(0,0,0,0.1);
  max-width:  54rem;
}

.ensuite-md-nav {}
.ensuite-md-nav ul { list-style: none; margin-top: 5rem; margin-right: 2rem; }
.ensuite-md-nav li a { display: inline-block; font-weight: bold; padding: 0.5rem 1rem; text-transform: uppercase; font-size: 0.9rem; line-height: 1rem }

.ensuite-md-toc {}
.ensuite-md-toc .table-of-contents { margin-top: 5rem; margin-left: 1rem; overflow: auto; }
.table-of-contents { overflow: auto }
.table-of-contents a { display: block; text-decoration: none; padding: 0.25rem 1.5rem 0.25rem }
.table-of-contents a:hover { text-decoration: underline 2px solid }
.table-of-contents li { margin: 0 0 }
.table-of-contents ul { font-weight: bold; margin-left: 0; list-style: none }
.table-of-contents ul ul { font-weight: normal; margin-left: 1em }


/*.ensuite-md-rendered .table-of-contents {*/
  /*position: fixed;*/
  /*top: 3rem;*/
  /*left: 0;*/
  /*bottom: 0;*/
  /*width: 38%;*/
  /*background: #476d3b;*/
  /*background: hsl(106 25% 25% / 1);*/
  /*color: white;*/
  /*padding: 1rem 0 2rem 1rem;*/
  /*border-right: 1px solid #888;*/
  /*display: flex;*/
  /*justify-content: flex-end;*/
/*}*/
.ensuite-md-rendered h2 { margin-top: 2.5rem; margin-bottom: 0.5rem; }
.ensuite-md-rendered h3 { margin-top: 1.5rem; margin-bottom: 0.5rem; }

ul { margin-left: 0; margin-bottom: 1em; }

p > code { font-weight: bold; color: #345 }
pre > code {
  display: block;
  border: 1px solid #888;
  padding: 0.5rem 1rem;
  margin-bottom: 1rem;
  background: rgba(255,255,255,0.5);
  box-shadow: 2px 2px 2px #888;
  overflow-x: auto;
  margin: 1rem -1rem;
}
pre > code.language-sh {
  background: #123;
  border-radius: 0;
  color: #fe0;
}
pre > code.language-typescript {
  background: #ffe;
  border-radius: 0.15rem;
}

.ensuite-md-header {
  z-index: 100;
  display: flex;
  flex-flow: row nowrap;
  justify-content: space-between;
  text-align: left;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 3rem;
  font-size: 1.5rem;
  line-height: 3rem;
  margin: 0;
  padding: 0 1rem;
  font-weight: bold;
  background: hsl(106 30% 33% / 1);
  color: white;
  width: 100%;
  max-width: 100%;
  font-weight: normal
}
.ensuite-md-separator {
  flex-grow: 1;
}
.ensuite-md-header a {
  color: white;
}
.ensuite-md-header .ensuite-md-title {
}
.ensuite-md-header .ensuite-md-link {
  font-size: 1rem;
  margin-left: 1rem;
}

.hljs-comment, .hljs-deletion, .hljs-meta, .hljs-quote {
  color: green;
}
.hljs.language-sh .hljs-built_in {
  color: inherit;
}
.hljs.language-sh .hljs-comment {
  color: tomato;
}

hr {
  margin: 1rem -1rem;
}
</style>
<header class="ensuite-md-header">
<a class="ensuite-md-title" href="/">The <strong>Fadroma</strong> Guide</a>
<div class="ensuite-md-separator"></div>
<a class="ensuite-md-link" href=/>Homepage</a>
<a class="ensuite-md-link" href=/guide.html>Documentation</a>
<a class="ensuite-md-link" href=https://github.com/hackbg/fadroma>Github</a>
<a class="ensuite-md-link" href=https://crates.io/search?q=fadroma>Crates.io</a>
<a class="ensuite-md-link" href=https://www.npmjs.com/search?q=fadroma>NPM</a>
<a class="ensuite-md-link" href=https://hack.bg/>Hack.bg</a>
</header>
<div class="ensuite-md-rendered">
<nav class="ensuite-md-nav"><ul>
<li><a class="ensuite-md-link" href=/guide.html>Getting started</a></li>
<li><a class="ensuite-md-link" href=/project.html>Projects</a></li>
<li><a class="ensuite-md-link" href=/agent.html>Agent API</a></li>
<li><a class="ensuite-md-link" href=/scrt.html>Secret Network</a></li>
<li><a class="ensuite-md-link" href=/dsl.html>Macro DSL</a></li>
<li><a class="ensuite-md-link" href=/build.html>Building</a></li>
<li><a class="ensuite-md-link" href=/upload.html>Uploading</a></li>
<li><a class="ensuite-md-link" href=/deploy.html>Deploy API</a></li>
<li><a class="ensuite-md-link" href=/factory.html>Factories</a></li>
<li><a class="ensuite-md-link" href=/devnet.html>Devnets</a></li>
<li><a class="ensuite-md-link" href=/mocknet.html>Mocknets</a></li>
</ul></nav>
<content class="ensuite-md-content"><div><p></div></p>
<h1 id="fadroma-dsl" tabindex="-1">Fadroma DSL</h1>
<p><strong>Procedural macro for composable boilerplate-free CosmWasm smart contracts.</strong></p>
<h2 id="introduction" tabindex="-1">Introduction</h2>
<p>Fadroma DSL takes care of all the necessary boilerplate in CosmWasm smart contracts
and provides a more productive development experience. There are two main goals the it aims to achieve.</p>
<p>The first is to generate the repetitive code that you'd write anyway but in a structured way such that you'd know what to expect when seeing a piece of code written using the DSL.</p>
<p>Secondly, it aims to provide a reliable and flexible system for composing common smart contract functionality and even extending entire contracts. That is, if you already have implemented admin functionality for example, you could easily add this to your contract and extend/change whatever you need just as easily. The granularity of this extends to the individual functions. Furthermore, your module could require some other module in order for it to work. You can enforce this with the DSL such that it will be a compile error if you didn't include what is needed.</p>
<p>Any misuse of the macro will result in <strong>compile errors</strong> and not some hidden or unexpected runtime behavior. Additionally, the macro error messages should tell you exactly what you need to add or change in order for it to compile.</p>
<h2 id="usage" tabindex="-1">Usage</h2>
<p>If you are already familiar with CosmWasm contracts then it should be easier to understand Fadroma DSL and why it does the things the way it does. Otherwise it might be better to get acquainted with that first. Also see the <a href="https://github.com/hackbg/fadroma/tree/master/examples">examples</a> in the Fadroma repo which showcase how to use the DSL and use modules defined in Fadroma (that also use the DSL) with or without it.</p>
<p>The DSL has the following attributes defined:</p>
<p><strong>Note that you don't you don't have to remember all the attributes and rules around them because the compiler will guide you.</strong></p>
<h3 id="contract" tabindex="-1"><strong>contract</strong></h3>
<p>Only valid for <code>mod</code> items. The <code>mod</code> will contain the entire implementation of your contract. It generates a zero-sized <code>Contract</code> struct which you <strong>must</strong> use to implement the contract methods as well as any interfaces that you wish. All methods marked with any of the <code>#[init]</code>, <code>#[execute]</code> or <code>#[query]</code> attributes will be included as part of the available functionality that the contract exposes. Though, you are free to write any other <code>Contract</code> methods or functions inside the module as well. Interfaces are implemented for the contract using the standard Rust syntax i.e <code>impl MyTrait for Contract { ... }</code> where <code>MyTrait</code> is a trait declared with the <code>#[interface]</code> attribute. Technically you can use any trait that satisfies the types that <code>#[interface]</code> requires and it won't break anything since the macro enforces that. The macro also generates an <code>Error</code> enum that represents all possible errors that you use across your contract and the interfaces that it implements. This is used in the generated <code>execute</code> and <code>query</code> functions but rather an implementation detail that ties everything together. On the other hand, it's there if you want to use it for anything.</p>
<h3 id="interface" tabindex="-1"><strong>interface</strong></h3>
<p>Unless you have multiple contracts that talk to eachother, you don't need this attribute and can just use <code>#[contract]</code>. But when that is the case, this attribute allows to define the interface of your contract separately and generate its <code>InstantiateMsg</code> (if present), <code>ExecuteMsg</code> and <code>QueryMsg</code>. This means that the interface can be defined in a separate crate and can be consumed by multiple other crates that implement a contract. This approach plays well with the common pattern of defining all contract messages in a single crate and having the contract crates use that to implement and call eachother. In addition, having to implement the interface trait in your contract means that Rust will never let the interface and implementation go out of sync. The interfaces forces you to declare the associated type <code>type Error: std::fmt::Display;</code> and all methods must return that as an error type. This is allows to have a custom error type. Otherwise, just use <code>cosmwasm_std::StdError</code>.</p>
<h3 id="init" tabindex="-1"><strong>init</strong></h3>
<p>The instantiate method for the contract. There can be only one per contract but each interface that your contract implements
must have it as well if it has it defined. Can be omitted altogether both in <code>#[contract]</code> and <code>#[interface]</code> contexts. When used in the latter, it will simply generate an <code>InstantiateMsg</code> struct. In the former it only serves as a marker inside any implemented
interfaces unless the <code>entry</code> meta argument is used.</p>
<h4 id="meta-arguments" tabindex="-1">Meta arguments</h4>
<ul>
<li><code>entry</code>
<ul>
<li>Used as <code>#[init(entry)]</code> and creates the <code>InstantiateMsg</code>, <code>ExecuteMsg</code> and <code>QueryMsg</code> structs, the <code>instantiate</code>, <code>execute</code> and <code>query</code> entry point functions.</li>
<li>Is optional.</li>
<li>Can only be used in <code>#[contract]</code>.</li>
<li>Only a single <code>#[init]</code> can be marked with it and this includes any interfaces that the contract implements.</li>
<li>If you have an <code>#[init]</code> attribute in one of your contract methods (inside the <code>impl Contract</code> block) you must add
this attribute. The reasoning for this being that since this is what generates the message enums and entry functions,
having an <code>#[init]</code> attribute in a contract method (but not in interface methods) without it would basically do nothing.</li>
</ul>
</li>
<li><code>entry_wasm</code>
<ul>
<li>Generates the same boilerplate and has the same rules as the <code>entry</code> meta but will also generate the WASM boilerplate FFI module.</li>
</ul>
</li>
</ul>
<h3 id="execute" tabindex="-1"><strong>execute</strong></h3>
<p>A method that is part of the executable set of methods of the contract. Each method that is to be part of that set must be annotated with that. The generated <code>ExecuteMsg</code> enum is comprised of the names of all those methods. Dispatch also happens automatically through the generated <code>execute</code> functions. This is all code that you'd write yourself.</p>
<h3 id="query" tabindex="-1"><strong>query</strong></h3>
<p>Identical to how the <code>#[execute]</code> attribute works but generated the <code>QueryMsg</code> enum and the <code>query</code> function.</p>
<h3 id="reply" tabindex="-1"><strong>reply</strong></h3>
<p>Marks the method as a CosmWasm reply handler. Only <strong>one</strong> such function can exist per contract and it must have a single parameter with the <code>cosmwasm_std::Reply</code> type.</p>
<h3 id="execute_guard" tabindex="-1"><strong>execute_guard</strong></h3>
<p>An execute guard function is a special function that is called before matching the <code>ExecuteMsg</code> enum inside the <code>execute</code> function both of which are generated by the macro. Only <strong>one</strong> such function can exist per contract and it must have a single parameter with the <code>&amp;ExecuteMsg</code> type.</p>
<p>It is useful in cases where we want to assert some state before proceeding with executing the incoming message and fail before that if necessary. For <a href="https://github.com/hackbg/fadroma/blob/master/examples/derive-contract-components/src/lib.rs#L24-L38">example</a>, it should be used with Fadroma's killswitch component. Inside the execute guard we check whether the contract is pausing or migrated and return an <code>Err(())</code> if so.</p>
<h3 id="auto_impl" tabindex="-1"><strong>auto_impl</strong></h3>
<p>Only valid for trait <code>impl</code> blocks. It takes a path to a struct which implements the given interface trait being implemented. For each method that is part of the trait, it delegates the implementation to the given struct. We ensure that the provided struct exactly implements the trait by using Rust's fully qualified syntax (<code>&lt;MyStruct as Trait&gt;::method_name()</code>). It will also fill in the concrete <code>Error</code> type that the interface must have. You delegate the implementation to the struct by leaving the method body <strong>completely</strong> empty. Otherwise, writing a method body will use your code. This allows for great flexibility since you can implement an interface by using an existing implementation while allowing you to directly override any methods that you wish. For example:</p>
<pre><code class="hljs language-rust"><span class="hljs-meta">#[auto_impl(ImplementingStuct)]</span>
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">MyInterface</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Contract</span> {
  <span class="hljs-comment">// Here we leave the body empty and it will delegate the implementation to ImplementingStuct</span>
  <span class="hljs-meta">#[execute]</span>
  <span class="hljs-keyword">fn</span> <span class="hljs-title function_">first_method</span>(some_arg: <span class="hljs-type">u32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Response, <span class="hljs-keyword">Self</span>::Error&gt; {
    <span class="hljs-comment">// The macro inserts the following code here</span>
    <span class="hljs-comment">// &lt;ImplementingStuct as MyInterface&gt;::first_method(deps, env, info, some_arg)</span>
  }

  <span class="hljs-comment">// Here we provide our own implementation so ImplementingStuct is not used at all.</span>
  <span class="hljs-meta">#[execute]</span>
  <span class="hljs-keyword">fn</span> <span class="hljs-title function_">second_method</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Response, <span class="hljs-keyword">Self</span>::Error&gt; {
    <span class="hljs-title function_ invoke__">Ok</span>(Response::<span class="hljs-title function_ invoke__">default</span>())
  }
}
</code></pre>
<h4 id="meta-arguments-1" tabindex="-1">Meta arguments</h4>
<ul>
<li>Path to the struct that implements the trait</li>
<li>Not optional.</li>
</ul>
<h2 id="usage-1" tabindex="-1"><strong>Usage</strong></h2>
<p>Since their usage is always a fact in CosmWasm contracts, the <code>Deps/DepsMut</code>, <code>Env</code> and <code>MessageInfo</code> types are inserted as parameters in the relevant methods so that they don't need to be specified all the time. Any parameters that your message declares are appended after those in the method signature. The following table describes which attribute includes what parameters:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Parameter name</th>
<th>Parameter type</th>
</tr>
</thead>
<tbody>
<tr>
<td>init</td>
<td>deps</td>
<td>DepsMut</td>
</tr>
<tr>
<td>init</td>
<td>env</td>
<td>Env</td>
</tr>
<tr>
<td>init</td>
<td>info</td>
<td>MessageInfo</td>
</tr>
<tr>
<td>execute</td>
<td>deps</td>
<td>DepsMut</td>
</tr>
<tr>
<td>execute</td>
<td>env</td>
<td>Env</td>
</tr>
<tr>
<td>execute</td>
<td>info</td>
<td>MessageInfo</td>
</tr>
<tr>
<td>query</td>
<td>deps</td>
<td>Deps</td>
</tr>
<tr>
<td>query</td>
<td>env</td>
<td>Env</td>
</tr>
<tr>
<td>reply</td>
<td>deps</td>
<td>DepsMut</td>
</tr>
<tr>
<td>reply</td>
<td>env</td>
<td>Env</td>
</tr>
<tr>
<td>execute_guard</td>
<td>deps</td>
<td>DepsMut</td>
</tr>
<tr>
<td>execute_guard</td>
<td>env</td>
<td>&amp;Env</td>
</tr>
<tr>
<td>execute_guard</td>
<td>info</td>
<td>&amp;MessageInfo</td>
</tr>
</tbody>
</table>
<h2 id="comparison" tabindex="-1">Comparison</h2>
<p>To better understand what the macro generates here's a simple contract and what the generated code ends up looking like:</p>
<pre><code class="hljs language-rust"><span class="hljs-meta">#[fadroma::dsl::contract]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> counter_contract {
    <span class="hljs-keyword">use</span> fadroma::{
        dsl::*,
        admin::{<span class="hljs-keyword">self</span>, Admin, Mode},
        schemars,
        cosmwasm_std::{<span class="hljs-keyword">self</span>, Response, Addr, StdError}
    };

    <span class="hljs-keyword">impl</span> <span class="hljs-title class_">Contract</span> {
        <span class="hljs-meta">#[init(entry_wasm)]</span>
        <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(initial_value: <span class="hljs-type">u64</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Response, StdError&gt; {
            <span class="hljs-title function_ invoke__">Ok</span>(Response::<span class="hljs-title function_ invoke__">default</span>())
        }

        <span class="hljs-meta">#[execute]</span>
        <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">add</span>(value: <span class="hljs-type">u64</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Response, StdError&gt; {
            <span class="hljs-title function_ invoke__">Ok</span>(Response::<span class="hljs-title function_ invoke__">default</span>())
        }

        <span class="hljs-meta">#[query]</span>
        <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">value</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">u64</span>, StdError&gt; {
            <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-number">0</span>)
        }
    }

    <span class="hljs-meta">#[auto_impl(admin::DefaultImpl)]</span>
    <span class="hljs-keyword">impl</span> <span class="hljs-title class_">Admin</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Contract</span> {
        <span class="hljs-meta">#[execute]</span>
        <span class="hljs-keyword">fn</span> <span class="hljs-title function_">change_admin</span>(mode: <span class="hljs-type">Option</span>&lt;Mode&gt;) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Response, <span class="hljs-keyword">Self</span>::Error&gt; { }
    
        <span class="hljs-meta">#[query]</span>
        <span class="hljs-keyword">fn</span> <span class="hljs-title function_">admin</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">Option</span>&lt;Addr&gt;, <span class="hljs-keyword">Self</span>::Error&gt; { }
    }
}
</code></pre>
<p>will expand to:</p>
<pre><code class="hljs language-rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> counter_contract {
    <span class="hljs-keyword">use</span> fadroma::{
        dsl::*,
        admin::{<span class="hljs-keyword">self</span>, Admin, Mode},
        schemars,
        cosmwasm_std::{<span class="hljs-keyword">self</span>, Response, Addr, StdError}
    };

    <span class="hljs-meta">#[derive(Clone, Copy)]</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Contract</span>;

    <span class="hljs-keyword">impl</span> <span class="hljs-title class_">Contract</span> {
        <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(
            <span class="hljs-keyword">mut</span> deps: cosmwasm_std::DepsMut,
            env: cosmwasm_std::Env,
            info: cosmwasm_std::MessageInfo,
            initial_value: <span class="hljs-type">u64</span>,
        ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Response, StdError&gt; {
            <span class="hljs-title function_ invoke__">Ok</span>(Response::<span class="hljs-title function_ invoke__">default</span>())
        }

        <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">add</span>(
            <span class="hljs-keyword">mut</span> deps: cosmwasm_std::DepsMut,
            env: cosmwasm_std::Env,
            info: cosmwasm_std::MessageInfo,
            value: <span class="hljs-type">u64</span>,
        ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Response, StdError&gt; {
            <span class="hljs-title function_ invoke__">Ok</span>(Response::<span class="hljs-title function_ invoke__">default</span>())
        }

        <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">value</span>(
            deps: cosmwasm_std::Deps,
            env: cosmwasm_std::Env
        ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">u64</span>, StdError&gt; {
            <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-number">0</span>)
        }
    }

    <span class="hljs-keyword">impl</span> <span class="hljs-title class_">Admin</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Contract</span> {
        <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span> = &lt;admin::DefaultImpl <span class="hljs-keyword">as</span> Admin&gt;::Error;

        <span class="hljs-keyword">fn</span> <span class="hljs-title function_">change_admin</span>(
            <span class="hljs-keyword">mut</span> deps: cosmwasm_std::DepsMut,
            env: cosmwasm_std::Env,
            info: cosmwasm_std::MessageInfo,
            mode: <span class="hljs-type">Option</span>&lt;Mode&gt;,
        ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Response, <span class="hljs-keyword">Self</span>::Error&gt; {
            &lt;admin::DefaultImpl <span class="hljs-keyword">as</span> Admin&gt;::<span class="hljs-title function_ invoke__">change_admin</span>(deps, env, info, mode)
        }
        <span class="hljs-keyword">fn</span> <span class="hljs-title function_">admin</span>(
            deps: cosmwasm_std::Deps,
            env: cosmwasm_std::Env,
        ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">Option</span>&lt;Addr&gt;, <span class="hljs-keyword">Self</span>::Error&gt; {
            &lt;admin::DefaultImpl <span class="hljs-keyword">as</span> Admin&gt;::<span class="hljs-title function_ invoke__">admin</span>(deps, env)
        }
    }

    <span class="hljs-meta">#[derive(serde::Serialize, serde::Deserialize, schemars::JsonSchema, Debug)]</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">InstantiateMsg</span> {
        <span class="hljs-keyword">pub</span> initial_value: <span class="hljs-type">u64</span>,
    }

    <span class="hljs-meta">#[derive(serde::Serialize, serde::Deserialize, schemars::JsonSchema, Debug)]</span>
    <span class="hljs-meta">#[serde(rename_all = <span class="hljs-string">&quot;snake_case&quot;</span>)]</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ExecuteMsg</span> {
        Add { value: <span class="hljs-type">u64</span> },
        ChangeAdmin { mode: <span class="hljs-type">Option</span>&lt;Mode&gt; },
    }

    <span class="hljs-meta">#[derive(serde::Serialize, serde::Deserialize, schemars::JsonSchema, Debug)]</span>
    <span class="hljs-meta">#[serde(rename_all = <span class="hljs-string">&quot;snake_case&quot;</span>)]</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">QueryMsg</span> {
        Value {},
        Admin {},
    }

    <span class="hljs-meta">#[derive(Debug)]</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Error</span> {
        <span class="hljs-comment">// The macro needs this to signal errors when calling cosmwasm_std::to_binary</span>
        <span class="hljs-comment">// in the query function that it generates when the call fails.</span>
        <span class="hljs-meta">#[doc(hidden)]</span>
        <span class="hljs-title function_ invoke__">QueryResponseSerialize</span>(<span class="hljs-type">String</span>),
        <span class="hljs-comment">// We call this for every method inside the impl Contract block.</span>
        <span class="hljs-title function_ invoke__">Base</span>(StdError),
        <span class="hljs-comment">// One for each interface implemented.</span>
        <span class="hljs-title function_ invoke__">Admin</span>(&lt;Contract <span class="hljs-keyword">as</span> Admin&gt;::Error),
    }

    <span class="hljs-keyword">impl</span> <span class="hljs-title class_">std</span>::fmt::Display <span class="hljs-keyword">for</span> <span class="hljs-title class_">Error</span> {
        <span class="hljs-keyword">fn</span> <span class="hljs-title function_">fmt</span>(&amp;<span class="hljs-keyword">self</span>, f: &amp;<span class="hljs-keyword">mut</span> std::fmt::Formatter&lt;<span class="hljs-symbol">&#x27;_</span>&gt;) <span class="hljs-punctuation">-&gt;</span> std::fmt::<span class="hljs-type">Result</span> {
            <span class="hljs-keyword">match</span> <span class="hljs-keyword">self</span> {
                <span class="hljs-keyword">Self</span>::<span class="hljs-title function_ invoke__">QueryResponseSerialize</span>(msg) =&gt; f.<span class="hljs-title function_ invoke__">write_fmt</span>(
                    <span class="hljs-built_in">format_args!</span>(<span class="hljs-string">&quot;Error serializing query response: {}&quot;</span>, msg)
                ),
                <span class="hljs-keyword">Self</span>::<span class="hljs-title function_ invoke__">Base</span>(x) =&gt; std::fmt::Display::<span class="hljs-title function_ invoke__">fmt</span>(x, f),
                <span class="hljs-keyword">Self</span>::<span class="hljs-title function_ invoke__">Admin</span>(x) =&gt; std::fmt::Display::<span class="hljs-title function_ invoke__">fmt</span>(x, f),
            }
        }
    }

    <span class="hljs-keyword">impl</span> <span class="hljs-title class_">std</span>::error::Error <span class="hljs-keyword">for</span> <span class="hljs-title class_">Error</span> {}

    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">instantiate</span>(
        <span class="hljs-keyword">mut</span> deps: cosmwasm_std::DepsMut,
        env: cosmwasm_std::Env,
        info: cosmwasm_std::MessageInfo,
        msg: InstantiateMsg,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Response, StdError&gt; {
        Contract::<span class="hljs-title function_ invoke__">new</span>(deps, env, info, msg.initial_value)
    }

    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(
        <span class="hljs-keyword">mut</span> deps: cosmwasm_std::DepsMut,
        env: cosmwasm_std::Env,
        info: cosmwasm_std::MessageInfo,
        msg: ExecuteMsg,
    ) <span class="hljs-punctuation">-&gt;</span> std::result::<span class="hljs-type">Result</span>&lt;cosmwasm_std::Response, Error&gt; {
        <span class="hljs-keyword">match</span> msg {
            ExecuteMsg::Add { value } =&gt; {
                Contract::<span class="hljs-title function_ invoke__">add</span>(deps, env, info, value).<span class="hljs-title function_ invoke__">map_err</span>(|x| Error::<span class="hljs-title function_ invoke__">Base</span>(x))
            }
            ExecuteMsg::ChangeAdmin { mode } =&gt; {
                Contract::<span class="hljs-title function_ invoke__">change_admin</span>(deps, env, info, mode).<span class="hljs-title function_ invoke__">map_err</span>(|x| Error::<span class="hljs-title function_ invoke__">Admin</span>(x))
            }
        }
    }

    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">query</span>(
        deps: cosmwasm_std::Deps,
        env: cosmwasm_std::Env,
        msg: QueryMsg,
    ) <span class="hljs-punctuation">-&gt;</span> std::result::<span class="hljs-type">Result</span>&lt;cosmwasm_std::Binary, Error&gt; {
        <span class="hljs-keyword">match</span> msg {
            QueryMsg::Value {} =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-variable">result</span> = Contract::<span class="hljs-title function_ invoke__">value</span>(deps, env).<span class="hljs-title function_ invoke__">map_err</span>(|x| Error::<span class="hljs-title function_ invoke__">Base</span>(x))?;
                cosmwasm_std::<span class="hljs-title function_ invoke__">to_binary</span>(&amp;result)
                    .<span class="hljs-title function_ invoke__">map_err</span>(|x| Error::<span class="hljs-title function_ invoke__">QueryResponseSerialize</span>(x.<span class="hljs-title function_ invoke__">to_string</span>()))
            }
            QueryMsg::Admin {} =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-variable">result</span> = Contract::<span class="hljs-title function_ invoke__">admin</span>(deps, env).<span class="hljs-title function_ invoke__">map_err</span>(|x| Error::<span class="hljs-title function_ invoke__">Admin</span>(x))?;
                cosmwasm_std::<span class="hljs-title function_ invoke__">to_binary</span>(&amp;result)
                    .<span class="hljs-title function_ invoke__">map_err</span>(|x| Error::<span class="hljs-title function_ invoke__">QueryResponseSerialize</span>(x.<span class="hljs-title function_ invoke__">to_string</span>()))
            }
        }
    }

    <span class="hljs-meta">#[cfg(target_arch = <span class="hljs-string">&quot;wasm32&quot;</span>)]</span>
    <span class="hljs-keyword">mod</span> wasm_entry {
        <span class="hljs-keyword">use</span> super::cosmwasm_std::{do_instantiate, do_execute, do_query};

        <span class="hljs-meta">#[no_mangle]</span>
        <span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">instantiate</span>(env_ptr: <span class="hljs-type">u32</span>, info_ptr: <span class="hljs-type">u32</span>, msg_ptr: <span class="hljs-type">u32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">u32</span> {
            <span class="hljs-title function_ invoke__">do_instantiate</span>(&amp;super::instantiate, env_ptr, info_ptr, msg_ptr)
        }

        <span class="hljs-meta">#[no_mangle]</span>
        <span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(env_ptr: <span class="hljs-type">u32</span>, info_ptr: <span class="hljs-type">u32</span>, msg_ptr: <span class="hljs-type">u32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">u32</span> {
            <span class="hljs-title function_ invoke__">do_execute</span>(&amp;super::execute, env_ptr, info_ptr, msg_ptr)
        }

        <span class="hljs-meta">#[no_mangle]</span>
        <span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">query</span>(env_ptr: <span class="hljs-type">u32</span>, msg_ptr: <span class="hljs-type">u32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">u32</span> {
            <span class="hljs-title function_ invoke__">do_query</span>(&amp;super::query, env_ptr, msg_ptr)
        }
    }
}
</code></pre>
</content>
<nav class="ensuite-md-toc"><p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#usage">Usage</a><ul><li><a href="#contract">contract</a></li><li><a href="#interface">interface</a></li><li><a href="#init">init</a><ul><li><a href="#meta-arguments">Meta arguments</a></li></ul></li><li><a href="#execute">execute</a></li><li><a href="#query">query</a></li><li><a href="#reply">reply</a></li><li><a href="#execute_guard">execute_guard</a></li><li><a href="#auto_impl">auto_impl</a><ul><li><a href="#meta-arguments-1">Meta arguments</a></li></ul></li></ul></li><li><a href="#usage-1">Usage</a></li><li><a href="#comparison">Comparison</a></li></ul></div></p></nav>
</div>
</body>
</html>