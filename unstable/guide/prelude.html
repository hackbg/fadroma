<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Elements of Fadroma smart contracts | VitePress</title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/assets/style.7f746859.css">
    <link rel="modulepreload" href="/assets/app.e47c6291.js">
    <link rel="modulepreload" href="/assets/guide_prelude.md.71736872.lean.js">
    
    <script>(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-92a6092e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-300bcde0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-300bcde0> Skip to content </a><!--]--><!----><header class="VPNav no-sidebar" data-v-92a6092e data-v-340c8be8><div class="VPNavBar" data-v-340c8be8 data-v-1ec741f7><div class="container" data-v-1ec741f7><div class="VPNavBarTitle" data-v-1ec741f7 data-v-66c4cd45><a class="title" href="/" data-v-66c4cd45><!----><!--[-->VitePress<!--]--></a></div><div class="content" data-v-1ec741f7><!----><!----><!----><div class="VPNavBarAppearance appearance" data-v-1ec741f7 data-v-b6b11b72><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-b6b11b72 data-v-69ff704a data-v-33b789dc><span class="check" data-v-33b789dc><span class="icon" data-v-33b789dc><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-69ff704a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-69ff704a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-1ec741f7 data-v-1321f080 data-v-236ed7fc><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-236ed7fc><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-236ed7fc><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-236ed7fc><div class="VPMenu" data-v-236ed7fc data-v-386c8c22><!----><!--[--><!--[--><!----><div class="group" data-v-1321f080><div class="item appearance" data-v-1321f080><p class="label" data-v-1321f080>Appearance</p><div class="appearance-action" data-v-1321f080><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-1321f080 data-v-69ff704a data-v-33b789dc><span class="check" data-v-33b789dc><span class="icon" data-v-33b789dc><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-69ff704a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-69ff704a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1ec741f7 data-v-e8a849d6><span class="container" data-v-e8a849d6><span class="top" data-v-e8a849d6></span><span class="middle" data-v-e8a849d6></span><span class="bottom" data-v-e8a849d6></span></span></button></div></div></div><!----></header><!----><!----><div class="VPContent" id="VPContent" data-v-92a6092e data-v-37403dbd><div class="VPDoc" data-v-37403dbd data-v-6f5051a0><div class="container" data-v-6f5051a0><div class="aside" data-v-6f5051a0><div class="aside-curtain" data-v-6f5051a0></div><div class="aside-container" data-v-6f5051a0><div class="aside-content" data-v-6f5051a0><div class="VPDocAside" data-v-6f5051a0 data-v-4889908d><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-4889908d data-v-1322d3e4><div class="content" data-v-1322d3e4><div class="outline-marker" data-v-1322d3e4></div><div class="outline-title" data-v-1322d3e4>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-1322d3e4><span class="visually-hidden" id="doc-outline-aria-label" data-v-1322d3e4> Table of Contents for current page </span><ul class="root" data-v-1322d3e4><!--[--><li style="" data-v-1322d3e4><a class="outline-link" href="#examples" data-v-1322d3e4>Examples</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#create-a-subdirectory" data-v-1322d3e4>Create a subdirectory</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#write-the-crate-manifest" data-v-1322d3e4>Write the crate manifest</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#import-the-prelude" data-v-1322d3e4>Import the prelude</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#define-the-api" data-v-1322d3e4>Define the API</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#implement-the-handlers" data-v-1322d3e4>Implement the handlers</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#add-the-entry-point" data-v-1322d3e4>Add the entry point</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-4889908d></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6f5051a0><div class="content-container" data-v-6f5051a0><!--[--><!--]--><main class="main" data-v-6f5051a0><div style="position:relative;" class="vp-doc _guide_prelude" data-v-6f5051a0><div><h1 id="elements-of-fadroma-smart-contracts" tabindex="-1">Elements of Fadroma smart contracts <a class="header-anchor" href="#elements-of-fadroma-smart-contracts" aria-hidden="true">#</a></h1><p>CosmWasm contracts are simply WASM programs that run in a specific environment defined by the Cosmos runtime. This environment has the well-known blockchain features of being:</p><ul><li><strong>Append-only:</strong> every mutation is permanent.</li><li><strong>Distributed:</strong> it doesn&#39;t matter on whose server the program runs.</li><li><strong>Metered:</strong> mutations cost gas, paid in the chain&#39;s native token.</li></ul><p>Coming from an OOP background, it might be helpful to view smart contract programs as something like classes, and smart contract instances as globally persistent instances of those classes.</p><h2 id="examples" tabindex="-1">Examples <a class="header-anchor" href="#examples" aria-hidden="true">#</a></h2><p>Some simple single-file contracts can be seen at:</p><ul><li><a href="https://github.com/hackbg/fadroma/tree/v100/examples/echo" target="_blank" rel="noopener noreferrer">https://github.com/hackbg/fadroma/tree/v100/examples/echo</a></li><li><a href="https://github.com/hackbg/fadroma/tree/v100/examples/kv" target="_blank" rel="noopener noreferrer">https://github.com/hackbg/fadroma/tree/v100/examples/kv</a></li></ul><p>What follows is a step-by-step guide for adding a contract to your project, with explanations of what role each step fulfills.</p><h2 id="create-a-subdirectory" tabindex="-1">Create a subdirectory <a class="header-anchor" href="#create-a-subdirectory" aria-hidden="true">#</a></h2><p>Each Fadroma contract is a Rust crate, and exists in a separate subdirectory of your project.</p><div class="language-shell"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># in &quot;my-project&quot; directory:</span></span>
<span class="line"><span style="color:#A6ACCD;">mkdir -p contracts/my-contract</span></span>
<span class="line"></span></code></pre></div><p>Add it to your project&#39;s global <code>Cargo.toml</code>:</p><div class="language-toml"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># my-project/Cargo.toml</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">workspace</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">members </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">contracts/my-contract</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><h2 id="write-the-crate-manifest" tabindex="-1">Write the crate manifest <a class="header-anchor" href="#write-the-crate-manifest" aria-hidden="true">#</a></h2><p>The first thing a Rust crate needs is a <code>Cargo.toml</code>.</p><div class="language-toml"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># my-project/contracts/my-contract/Cargo.toml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">package</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">name    </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">my-contract</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">version </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0.1.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">edition </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2018</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">lib</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">crate-type </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cdylib</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">rlib</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">path       </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">my_contract.rs</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">dependencies</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">fadroma </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> version </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">100.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">serde   </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> version </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0.103</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> default-features </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> features </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">derive</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><blockquote><p>We deviate from Rust&#39;s recommendation of having a <code>src/</code> subdirectory, so as not to overcomplicate the directory structure of projects.</p></blockquote><h2 id="import-the-prelude" tabindex="-1">Import the prelude <a class="header-anchor" href="#import-the-prelude" aria-hidden="true">#</a></h2><p>Now, let&#39;s write some Rust!</p><p>Each Fadroma contract consists of one or more <strong>Rust source files</strong> that define the interface and implementation.</p><p>The <code>fadroma::prelude</code> module exposes the underlying platform&#39;s native libraries, as well as useful Fadroma primitives.</p><div class="language-rust"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">/* my-project/contracts/my-contract/my_contract.rs */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> fadroma</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">prelude</span><span style="color:#89DDFF;">::*;</span></span>
<span class="line"></span></code></pre></div><h2 id="define-the-api" tabindex="-1">Define the API <a class="header-anchor" href="#define-the-api" aria-hidden="true">#</a></h2><p>The API of a smart contract consists of 3 types of messages:</p><ul><li><strong>The init message</strong> corresponds to the &quot;constructor&quot; of the &quot;class&quot;. It is called once, when instantiating the contract, and is represented by a <code>struct</code>, not an <code>enum</code>, because it has no variants.</li><li><strong>The handle messages</strong> are represented by an <code>enum</code> corresponding to the &quot;methods&quot; of the &quot;class&quot;. These methods are called from transactions, and they are always written to the blockchain. Therefore, they cost gas, and can mutate the contract state.</li><li><strong>The query messages</strong> are represented by an <code>enum</code> corresponding to &quot;getters&quot;. You can pass parameters to them, and they can read from the contract state, but they can&#39;t perform mutations, and, unlike init and handle, don&#39;t have access to the <code>env</code> struct which contains info such as the sender address and the current time.</li></ul><div class="language-rust"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">/* my-project/contracts/my-contract/my_contract.rs (continued) */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">InitMsg</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* init fields - your &quot;constructor arguments&quot; */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">enum</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">HandleMsg</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Tx1</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">                      // &quot;tx1&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">Tx2</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Uint128</span><span style="color:#89DDFF;">),</span><span style="color:#676E95;font-style:italic;">             // {&quot;tx2&quot;:&quot;12345&quot;}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Tx3</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{},</span><span style="color:#676E95;font-style:italic;">                   // {&quot;tx3:{}},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Tx4</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> my_value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Uint128</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#676E95;font-style:italic;"> // {&quot;tx4&quot;:{&quot;my_value&quot;:&quot;12345&quot;}}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">#[</span><span style="color:#A6ACCD;">message</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">enum</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">QueryMsg</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Q1</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">                      // &quot;q1&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">Q2</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Uint128</span><span style="color:#89DDFF;">),</span><span style="color:#676E95;font-style:italic;">             // {&quot;q2&quot;:&quot;12345&quot;}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Q3</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{},</span><span style="color:#676E95;font-style:italic;">                   // {&quot;q3:{}},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Q4</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> my_value</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Uint128</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#676E95;font-style:italic;"> // {&quot;q4&quot;:{&quot;my_value&quot;:&quot;12345&quot;}}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="implement-the-handlers" tabindex="-1">Implement the handlers <a class="header-anchor" href="#implement-the-handlers" aria-hidden="true">#</a></h2><div class="language-rust"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">/* my-project/contracts/my-contract/my_contract.rs (continued) */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">init</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">S</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Storage</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">A</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Api</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Q</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Querier</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    deps</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Extern</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">S</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">A</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Q</span><span style="color:#89DDFF;">&gt;,</span><span style="color:#A6ACCD;"> env</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Env</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> msg</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">InitMsg</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">StdResult</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">InitResponse</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* implementation of your init procedure */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">handle</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">S</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Storage</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">A</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Api</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Q</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Querier</span><span style="color:#89DDFF;">&gt;(</span></span>
<span class="line"><span style="color:#A6ACCD;">    _deps</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#C792EA;">mut</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Extern</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">S</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">A</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Q</span><span style="color:#89DDFF;">&gt;,</span><span style="color:#A6ACCD;"> _env</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Env</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> msg</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">HandleMsg</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">StdResult</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">HandleResponse</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* dispatch and implement transactions */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">pub</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">fn</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">query</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">S</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Storage</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">A</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Api</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Q</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Querier</span><span style="color:#89DDFF;">&gt;(</span></span>
<span class="line"><span style="color:#A6ACCD;">    _deps</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#FFCB6B;">Extern</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">S</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">A</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Q</span><span style="color:#89DDFF;">&gt;,</span><span style="color:#A6ACCD;"> msg</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">QueryMsg</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">StdResult</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Binary</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* dispatch and implement queries */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="add-the-entry-point" tabindex="-1">Add the entry point <a class="header-anchor" href="#add-the-entry-point" aria-hidden="true">#</a></h2><p>The <code>fadroma::entrypoint!</code> macro binds the <code>init</code>, <code>handle</code>, and <code>query</code> to the CosmWasm environment. When building for production, it defines a hidden <code>mod wasm</code> module that calls the functions with the transaction data passed by the user.</p><div class="language-rust"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">/* my-project/contracts/my-contract/my_contract.rs (continued) */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">fadroma</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">entrypoint!</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fadroma</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> init</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> handle</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> query</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-6f5051a0 data-v-67e5d2c4><div class="edit-info" data-v-67e5d2c4><!----><!----></div><!----></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"changelog.md\":\"6fca1b17\",\"code_of_conduct.md\":\"0ee56ae0\",\"contributing.md\":\"69907b93\",\"internals.ts.md\":\"bc33aaf3\",\"maintainers.md\":\"22651fa6\",\"readme.md\":\"3a6596c5\",\"roadmap.ts.md\":\"4010d9f8\",\"spec.ts.md\":\"436b66f9\",\"testing.ts.md\":\"32c3d76d\",\"crates_fadroma-platform-scrt_readme.md\":\"7d660bdc\",\"crates_fadroma-proc-derive_readme.md\":\"a928798a\",\"crates_fadroma_readme.md\":\"bceb31f7\",\"crates_fadroma_composability_readme.md\":\"3ceb5c17\",\"crates_fadroma_ensemble_readme.md\":\"b4df08cd\",\"crates_fadroma_math_readme.md\":\"a29a205d\",\"crates_fadroma_snip20_impl_readme.md\":\"854e0d70\",\"crates_fadroma_snip20_impl_tests_example-receiver_readme.md\":\"e02fc86e\",\"crates_fadroma_storage_readme.md\":\"8f5b4ef8\",\"examples_readme.md\":\"d26bae2c\",\"examples_echo_readme.md\":\"27607de6\",\"fixtures_readme.md\":\"bba082e0\",\"fixtures_genesis_readme.md\":\"1e666679\",\"guide_readme.md\":\"1c2e8cfa\",\"guide_client.md\":\"d4576e3d\",\"guide_contributing.md\":\"1963cbfd\",\"guide_derive.md\":\"d3f24906\",\"guide_ensemble.md\":\"28b8b39d\",\"guide_index.md\":\"bb6a4509\",\"guide_mocknet.md\":\"3ae2d802\",\"guide_operating.md\":\"c29b00e7\",\"guide_ops.md\":\"00b749aa\",\"guide_prelude.md\":\"71736872\",\"guide_project-setup.md\":\"8cd710fb\",\"index.md\":\"8efa5452\",\"packages_client-cw-0.16_readme.md\":\"b6b0c30b\",\"packages_client-cw-1_readme.md\":\"2c955197\",\"packages_client-evm_readme.md\":\"f4207c68\",\"packages_client-scrt-amino_readme.md\":\"bcfce31c\",\"packages_client-scrt-grpc_readme.md\":\"ac65d95c\",\"packages_client-scrt_readme.md\":\"12d455ee\",\"packages_client_readme.md\":\"7f098ee8\",\"packages_ops-scrt_readme.md\":\"51ab49bd\",\"packages_ops_readme.md\":\"df6e629e\",\"packages_tokens_readme.md\":\"75b728e0\"}")</script>
    <script type="module" async src="/assets/app.e47c6291.js"></script>
    
  </body>
</html>